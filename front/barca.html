<html>
<head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<style>
body {
    background-color: #99ccff;
}
h1 {
    color: Black;
}
.smallBox1{
	background-color: #ccff66;
	width: 10%;
	height: 10%;
	outline: 1px solid;
	float: left;
	display: flex;
}
.smallBox2{
	background-color: #80ffd4;
	width: 10%;
	height: 10%;
    outline: 1px solid;
    float: left;
	display: flex;
}
.smallBox1 > img {
	margin: 0 auto;
	width: 100%;
	height: 100%;
}
.smallBox2 > img{
	margin: 0 auto;
	width: 100%;
	height: 100%;
}
.mainBox{
	background-color: #92f359;
	width: 90%;
	height: 90%;
	margin: 3%;
	border-style: solid;
	z-index: 1;	
}

</style>
<script>
var barca_array = [
	['.','.','.','.','BE1','BE2','.','.','.','.'],
	['.','.','.','BL1','BR1','BR2','BL2','.','.','.'],
	['.','.','.','.','.','.','.','.','.','.'],
	['.','.','.','.','.','.','.','.','.','.'],
	['.','.','.','.','.','.','.','.','.','.'],
	['.','.','.','.','.','.','.','.','.','.'],
	['.','.','.','.','.','.','.','.','.','.'],
	['.','.','.','.','.','.','.','.','.','.'],
	['.','.','.','WL1','WR1','WR2','WL2','.','.','.'],
	['.','.','.','.','WE1','WE2','.','.','.','.']
];
var request = {
	"whitemovetomake":true,
	"humanmovetomake":true,
	"victory":false,
	"pieces":[],
	"human_source":null,
	"human_dest":null
}
var clicks_made = [];
var player_TURN = "WHITE";
var valid_clicks = [];
var trapped_pieces = [];
var scared_pieces = [];
var checkForValue = function(i,j){
	if((i+j)%2 != 0)
	{
		return (player_TURN === "WHITE") ? "smallBox1" : "smallBox2"; 
	}
	else
	{
		return (player_TURN === "WHITE") ? "smallBox2" : "smallBox1";
	}
}
/*Function that initializes the board*/
function newBoard(){
	var output = "";
	for(var i = 0; i < 10; i++){
		for(var j = 0; j < 10; j++){
			var title = "tile_"+i+","+j;
			output += '<div id= \''+title+'\' class="'+ checkForValue(i,j) + '" onclick = "clickMade(\''+i+'\',\''+j+'\',\''+title+'\',\''+barca_array[i][j]+'\')"></div>';
		}
	}
	document.getElementById('barca_board').innerHTML = output;
}
/*Function that positions initial images onto the board*/
function placeInitImage(){
	document.getElementById('tile_0,4').innerHTML += '<img src = "./images/ElephantB.png"/>';
	document.getElementById('tile_0,5').innerHTML += '<img src = "./images/ElephantB.png"/>';
	document.getElementById('tile_9,4').innerHTML += '<img src = "./images/elephantW.gif"/>';
	document.getElementById('tile_9,5').innerHTML += '<img src = "./images/elephantW.gif"/>';
	document.getElementById('tile_1,3').innerHTML += '<img src = "./images/LionB.png"/>';
	document.getElementById('tile_1,4').innerHTML += '<img src = "./images/MouseB.png"/>';
	document.getElementById('tile_1,5').innerHTML += '<img src = "./images/MouseB.png"/>';
	document.getElementById('tile_1,6').innerHTML += '<img src = "./images/LionB.png"/>';
	document.getElementById('tile_8,3').innerHTML += '<img src = "./images/lionW.gif"/>';
	document.getElementById('tile_8,4').innerHTML += '<img src = "./images/mouseW.gif"/>';
	document.getElementById('tile_8,5').innerHTML += '<img src = "./images/mouseW.gif"/>';
	document.getElementById('tile_8,6').innerHTML += '<img src = "./images/lionW.gif"/>';
}
function initValidClicks(){
	if(player_TURN == "WHITE"){
		valid_clicks.push("8,3");
		valid_clicks.push("8,4");
		valid_clicks.push("8,5");
		valid_clicks.push("8,6");
		valid_clicks.push("9,4");
		valid_clicks.push("9,5");		
	}
}
function verifyValidMove(from_row,from_col,to_row,to_col){
	return true; // for now but it needs to be changed
}
function verifyValidClick(str){
	for(var i = 0; i < valid_clicks.length; i++){
		if(valid_clicks[i] === str){
			return true;
		}
	}
	return false;
}
function recomputeValidClicks(turn){

}
/*Function that detects clicks and displays a message about where the click
	was made*/
function clickMade(id,row,col,val){
	/*document.getElementById("message").innerHTML = "Click made at this value " + val + ", id: " + id;*/
	var str = row + "," + col;
	if(verifyValidClick(str)){
		clicks_made = [];
		clicks_made.push(str);
		document.getElementById("message").innerHTML = "Choose where you want to move the piece to or select another piece to move...";
	}
	else if(clicks_made.length == 1){
		var rl = parseInt(clicks_made[0][0]);
		var cl = parseInt(clicks_made[0][2]);
		row = parseInt(row);
		row = parseInt(col);
		if(verifyValidMove(rl,cl,row,col))
		{
			document.getElementById("tile_"+clicks_made[0]).innerHTML = "";
			if(barca_array[rl][cl][0] == "B")
			{
				if(barca_array[r1][c1][1] == "E"){
					document.getElementById("tile_"+row+","+col).innerHTML = '<img src = "./images/ElephantB.png"/>';								
				}
				else if(barca_array[r1][c1][1] == "R"){
					document.getElementById("tile_"+row+","+col).innerHTML = '<img src = "./images/MouseB.png"/>';				
				}
				else{
					document.getElementById("tile_"+row+","+col).innerHTML = '<img src = "./images/LionB.png"/>';
				}
			}
			else
			{
				if(barca_array[r1][c1][1] == "E"){
					document.getElementById("tile_"+row+","+col).innerHTML = '<img src = "./images/elephantW.gif"/>';								
				}
				else if(barca_array[r1][c1][1] == "R"){
					document.getElementById("tile_"+row+","+col).innerHTML = '<img src = "./images/mouseW.gif"/>';				
				}
				else{
					document.getElementById("tile_"+row+","+col).innerHTML = '<img src = "./images/lionW.gif"/>';
				}
			}
			barca_array[row][col] = barca_array[rl][cl];
			barca_array[rl][cl] = '.';
			/*Send API request*/
			/*Get the move from AI*/
			/*Compute new valid clicks and set new trapped and feared pieces*/
			recomputeValidClicks();
			/*Set clicks_made to empty array*/
			clicks_made = [];
		}
		else{
			document.getElementById("message").innerHTML = "Invalid Move. Please select a valid move...";
		}
	}
	else{
		document.getElementById("message").innerHTML = "Invalid Move. Please select a valid move...";
	}
}
</script>
</head>
<body>
<div class = "row">
	<div class = "col-xs-1"></div>
	<div class = "col-xs-3">
		<h4>Welcome To Barca!</h4>
	</div>
	<div class = "col-xs-8">
<!--		Choose side... &nbsp; &nbsp;
		<select class = "selectpicker show-tick" id = "player">		
		  <option value="white">White</option>
		  <option value="black">Black</option>
		</select> &nbsp; &nbsp;
		<button type = "button" class = "btn btn-primary" id = "player-selection">Start Game!</button>				
-->
	</div>	
</div>
<div class = "row">
	<div class = "col-xs-12 text-center" id = "message"></div>
</div>
<br>
<div id="barca_board" class = "mainBox"></div>
<script>newBoard();</script>
<script>placeInitImage();</script>
<script>initValidClicks();</script>
</body>
</html>